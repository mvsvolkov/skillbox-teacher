# Описание решения задания по разработке новостного сайта с админкой. 

Для быстрого и безошибочного создания программного кода можно воспользоваться консольной командой фреймворка `make` (бандл `Maker`).   
Команда `make` поможет сгенерировать множество различных классов.  

Рекомендую, также воспользоваться консольной командной `list` с параметром make, чтобы посмотреть все доступные генераторы бандла Maker:  
`$ php bin/console list make`

## Блок I - Модель хранения данных
Начать решение задачи рекомендую с создания модели хранения данных согласно реализованной в symfony схеме:  

1. Создание сущности (команда make:entity)  
ссылка на документацию https://symfony.com/doc/current/doctrine.html#creating-an-entity-class

Рекомендуется после создания сущности, ознакомиться с программным кодом созданного класса и добавить свой код:  
- непример, заполнение поля "Дата создания" при создании сущности, заполнение этого поля в конструкторе  
(наилучшим решением для данного шага будет проверка только что внесенных изменений unit-тестом)

2. Создание миграции на основе созданных сущностей (команда make:migration)  
ссылка на документацию https://symfony.com/doc/current/doctrine.html#migrations-creating-the-database-tables-schema

Рекомендуется после создания миграции, ознакомиться с программным кодом миграции и добавить свои sql-команды  
- например, добавление какой-либо записи (новости) в ранее созданную таблицу  
(наилучшим решением будет использование фикстур с генерированием рандомных данных компонентом `Faker` 
и формированием slug из названия статьи с использованием компонента `Slugify`)  

3. Выполнение миграций и внесение изменений в базу данных (команда doctrine:migrations:migrate)
ссылка на документацию https://symfony.com/doc/current/doctrine.html#migrations-creating-the-database-tables-schema

Итого, схема создания модели хранения состоит из (1) создания сущности (2) создания миграции, фикстур для генерации тестовых данных и (3) выполнения миграций для внесения изменений в базу данных.  
Убедитесь в том, что таблица была добавлена в базу данных и в ней появилась одна или несколько записей.  

## Блок II - Главная и детальная страницы сайта
Теперь, когда в базе данных есть данные, их можно вывести на главной странице в виде списка и открыть детальную страницу с информацией о выбранной новости, 
при нажатии на ее заголовок в списке.  
Для этого создайте контроллер новостей с заданием маршрутов с помощью аннотаций.  

Один маршрут будет работать с репозитарием, который выдает все записи (упорядоченные в порядке убывания даты публикации)
и вызывает twig-шаблон главной таблицы.

Другой маршрут будет принимать параметр - идентификатор запрашиваемой записи и для него получать из репозитария нужную сущность,
отображая ее вызывом twig-шаблона детальной таблицы.  

Решение задачи предусматривает:  
- создание контролера (ссылка на документацию https://symfony.com/doc/current/controller.html);  
- работу с репозитарием (полезная ссылка https://symfonycasts.com/screencast/symfony4-doctrine/repository#controlling-the-order-by);   
- работу с шаблонизатором twig (ссылка на документацию https://symfony.com/doc/current/templates.html).  

Дополнительно необходимо обработать вариант 404-ошибки ("Страница не найдена")   
- проще и быстрее всего выдавать специально созданную twig-страницу  
(подробнее в документации https://symfony.com/doc/current/controller.html#managing-errors-and-404-pages)  

## Блок III - Админка
Создать простейшую админку, позволяющую создавать, изменять, удалять, просматривать записи таблицы (CRUD) можно одной командой
`make:crud` (ссылка на документацию https://symfony.com/doc/current/controller.html#generating-controllers)  

В сгенерированный код потребуется внести несколько дополнений, касающихся требований валидации для полей сущности  
(подробнее о валидации форм - https://symfony.com/doc/current/components/form.html#form-validation)  
Требования валидации (с выдачей соответствующего сообщения):  
 * название - строка, не менее 3-х символов  
 * символьный код - уникальная строка  
 * текст новости - текст, не менее 5 символов  
 * дата публикации - дата со временем  

## Блок IV - Аутентификации пользователя  
Необходимо выполнить последовательность шагов, указанных в документации https://symfony.com/doc/current/security.html  

Создать сущность пользователя - `make:user`  
Внести миграцией изменения в базу данных  
Создать первого пользователя с ролью администратора (любым из способов - посредством миграции/фикстуры/консольной команды)  
Создать форму аутентификации - make:auth  
Настроить (ограничить) доступ к админке - только для пользователя с правами администратора.  

Все эти шаги подробно описаны и объяснены по указанной ссылке в документации.  

## Блок V - Markdown преобразователь  
Необходимо создать отдельный сервис MarkdownConverterService в виде класса, принимающего интерфейс markdown-преобразования `MarkdownParserInterface`  
зарегистрировать класс как сервис (в config/services.yaml) с переменной окружения (в .env) `MARKDOWN_DISABLE_BOLD` (true/false)   
подключить к контроллеру с вызовом метода, реализующего преобразование текста новости (из markdown в html, для отображения на сайте).  

Подробнее о markdown-преобразовании https://github.com/KnpLabs/KnpMarkdownBundle  
Ссылка на документацию https://symfony.com/doc/current/best_practices.html#configuration

